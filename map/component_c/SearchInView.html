#go_back_total_result#
<div id="screening">
#result_title#
#screening#
</div> 
<div id="txtPanel" class="mapinfo_con">
<!--wjp cmsads -->
<div id="pos3" style="display:none"></div>
#suggest_query#
#pinyin_suggest#
#space_poi#
#list#
#page#
#place_entrance_wd#
#no_result#
#jump_back#
#feedback#
<!--wjp cmsads -->
<div id="pos4" style="display:none"></div>
</div>
<script>
function SearchInView(){T.lang.Class.call(this);this.MAX_RESULT_COUNT=760;this.itemsPerPage=10;this.json=null;this.curSelA=null;this.cmdNo=1;this.points=[];this.uids=[];this.markers=[];this.infoWnds=[];this.busStopPois=[];this.stationPoints=[];this.showIconIndices=[];this.curKw="";this.sugKw="";this.curItemPPage=0;this.curPage=0;this.totalCount=0;this.totalPage=0;this.curSelIndex=-1;this.centerPt=null;this.centerPoi=null;this.cInfoWnd=null;this.radius=0;this.isnbSearch=false;this.ctrPoiName="未知地点";this.ctrPoiUid="";this.busPolylines=[];this.normPolylines=[];this.normPolygons=[];this.sCityCode=0;this.sCityName="";this.reIndex=[];this.placeRe=window.place.placeRe;this.placeConfig=window.place.placeConfig;this.RED_ICON=new BMap.Icon(A_J_MARKER_IMG,A_J_MARKER_RED_SIZE,{offset:A_J_MARKER_OFFSET,imageOffset:new BMap.Size(0,-275),infoWindowOffset:A_J_MARKER_INFOWND_OFFSET});this.BLUE_ICON=new BMap.Icon(A_J_MARKER_IMG,A_J_MARKER_BLUE_SIZE,{offset:A_J_MARKER_BLUE_OFFSET,imageOffset:new BMap.Size(0,-156),infoWindowOffset:A_J_MARKER_INFOWND_OFFSET})}T.lang.inherits(SearchInView,T.lang.Class,"SearchInView");T.object.extend(SearchInView.prototype,{render:function(k,v){window.clearClarify&&clearClarify();var s=this.json=v;if(!s||!s.result){return}var m=s.result;this.curPage=m.page_num;this.totalCount=m.total;this.pagingCount=m.total;if(this.pagingCount>this.MAX_RESULT_COUNT){this.pagingCount=this.MAX_RESULT_COUNT}this.specialCount=m.page_num==0?m.spec_dispnum||0:0;this.displayCount=this.totalCount+this.specialCount;setSearchResult("在当前图区内找到"+this.displayCount+"条结果");this.curItemPPage=m.count;this.curKw=m.return_query||m.wd;this.sugKw=m.wd2||"";this.totalPage=Math.ceil(this.pagingCount/this.itemsPerPage);var w=s.content;this.cmdNo=m.cmd_no;if(s.current_city){this.sCityCode=s.current_city.code;this.sCityName=s.current_city.name;this.ctype=s.current_city.type}else{this.sCityCode=modelConfig.cityCode;this.sCityName=modelConfig.cityName}if(!this.isnbSearch){k=k.replace(/#go_back_total_result#/gi,'<div class="go_back_clear"><span>共有'+this.displayCount+'条结果</span><a href="javascript:void(0)" onclick="addStat(STAT_SEARCH_RETURN_NEW);go(\'cur&wd='+encodeURIComponent(modelConfig.cityName)+"',{cinfo:{notChangeMapCenter : true}});\">返回</a></div>")}if(v.place_info&&this.placeRe.test(v.place_info.d_data_type)){place.result=true;var f=this.guid;k=k.replace(/#screening#/,place.insertHtml(k,v,f))}this.centerCityCode=this.cinfo&&this.cinfo.oc||this.sCityCode;k=k.replace(/#suggest_query#/,"");k=k.replace(/#pinyin_suggest#/,"");k=k.replace(/#space_poi#/,"");if(m.total==0&&w&&w.length==0||m.total==0&&!w){if(this.json.result.op_gel==1&&this.json.result.res_l>0){window.GRControll.setGRequestFlg(1000);var p=new BMap.Point(this.json.result.res_x,this.json.result.res_y);var x=this;window.setTimeout(function(){map.centerAndZoom(p,x.json.result.res_l)},10)}return this._processNoResult(m,k)}k=k.replace(/#no_result#/,"");var d=[];k=k.replace(/#result_title#/,"");var a=[];var o=0;for(var t=0,q=m.count;t<q;t++){if(w[t].poiType!=POI_TYPE_BUSLINE&&w[t].poiType!=POI_TYPE_SUBLINE){o++;this.showIconIndices[t]=o}this._setColContent(w,t,a,o);this.uids.push(w[t].uid);if(w[t].poiType==POI_TYPE_BUSLINE||w[t].poiType==POI_TYPE_SUBLINE){this.markers.push("");this.points.push("");continue}var y=parseGeo(w[t].geo);if(y.type==1){this.markers.push(addSearchPoi(y.points,o-1,w[t].name));this.points.push(getPointByStr(y.points))}}k=k.replace(/#list#/,'<table cellspacing="0" cellpadding="0" class="result black">'+a.join("")+"</table>");k=k.replace(/#page#/,'<div id="result_page_c"></div>');if(!place.result&&w[0]&&((w[0].cla&&w[0].cla[0]&&w[0].cla[0][0]&&w[0].geo)||(w[0].poi_origin&&w[0].poi_origin==33))){var e=null;var h=w[0].geo;var n="";var u={nb_x:placeEntrance.execGeo(h).x,nb_y:placeEntrance.execGeo(h).y,uid:w[0].uid};if(w[0].poi_origin==33){e=33;n=w[0].name}else{if(w[0].cla&&w[0].cla[0]&&w[0].cla[0][0]&&w[0].geo){e=w[0].cla[0][0]}}var b={13:true,14:true,18:true,20:true,33:true};if(b[e]){k=k.replace(/#place_entrance_wd#/,'<div id="place_tag">'+placeEntrance.insertHtml(e,this.sCityCode,u.nb_x,u.nb_y,u.uid,n)+"</div>")}else{k=k.replace(/#place_entrance_wd#/,"")}}else{k=k.replace(/#place_entrance_wd#/,"")}k=k.replace(/#feedback#/,'<div id="user_feedback" class="blueC">易格时空提醒您：结果有错误？请到<a id="mapComplaintCenter" target="_blank" onClick="addStat(STAT_TOUSU_LIST_NOR)"href="http://tousu.baidu.com/map/add">易格时空地图投诉中心</a>反馈。</div>');var q=m.res_l,g=new BMap.Point(m.res_x,m.res_y);if(map.getZoom()!=q||!map.getCenter().equals(g)){window.GRControll.setGRequestFlg(1000);map.centerAndZoom(g,q)}return k},initialize:function(){var v=this;if(!!place.result){var j=T.G("tagBar"),m=T.G("priceBar");if(place.barState.price.display){place.showBar(m,"price")}else{place.hideBar(m,"price")}if(place.barState.tag.display){place.showBar(j,"tag")}else{place.hideBar(j,"tag")}}var s=this.markers;for(var r=0,q=s.length;r<q;r++){(function(){var l=r;var i=v.json.content[l].poiType;if(s[r]&&s[r].isVisible()){s[r].addEventListener("click",function(){v.select(l,{statCode:STAT_GR_MARKER_CLICK,ct:"mk"})});s[r].addEventListener("mouseover",function(){v._itemOver(T.G("item-td-"+l),l,i)});s[r].addEventListener("mouseout",function(){v._itemOut(T.G("item-td-"+l),l,i)})}var n=T.G("no"+(r+1));T.on(n,"mouseover",function(){v._itemOver(null,l,i)});T.on(n,"mouseout",function(){v._itemOut(null,l,i)});T.on(T.G("item-td-"+l),"click",function(){v.select(l,{statCode:STAT_GR_MARKER_CLICK})})})()}if(this.pagingCount>10){var d=this.sugKw?1:0;var u="&db="+this.json.result.db;var t=new Page("result_page_c",function(l){var n="&on_gel=1&src=7&gr=3";var i=map.getBounds();n+="&b=("+i.minX+","+i.minY+";"+i.maxX+","+i.maxY+")&l="+map.zoomLevel;GRControll.openedMarker=null;GRControll.noRemoveTip1=true;go("bd&c="+v.sCityCode+place.urlArr+"&wd="+encodeURIComponent(v.curKw)+"&pn="+(l-1)+u+"&rn=10&wd2="+encodeURIComponent(v.sugKw)+"&sug="+d+n)},{pageCount:v.totalPage,page:v.curPage+1,update:false})}if(GRControll.openedMarker){var c=false;if(this.json&&this.json.content){for(var r=0,o=this.json.content.length;r<o;r++){var g=this.json.content[r];if(g&&g.uid&&g.uid==GRControll.openedMarker.uid){this.setMarkerOpenInUrl(r,-1,-1,{notMove:true,notZoom:true});c=true;break}}}if(!c){this.setMissingMarker()}}if(this.cinfo){if(this.cinfo._maplevel&&this.cinfo._centerPoint){}else{if(this.cinfo._maplevel){map.zoomTo(this.cinfo._maplevel)}}if(typeof this.cinfo._index!="undefined"&&v.json&&v.json.content){var p=this.cinfo._index.split("|")&&this.cinfo._index.split("|")[0]||this.cinfo._index;var k=this.cinfo._index.split("|")&&this.cinfo._index.split("|")[1]||-1;var f=this.cinfo._index.split("|")&&this.cinfo._index.split("|")[2]||-1;var a=this.cinfo._index.split("|")&&this.cinfo._index.split("|")[3]||"";var b=true;if(a!=""){if(v.json&&v.json.content&&v.json.content[p]){if(a!=v.json.content[p].uid){b=false}}}if(b){this.reIndex=[p,k,f];this.setMarkerOpenInUrl(p,k,f)}}}window.GRControll.setGRequestFlg(500);window.GRControll.setGRData(this.json,{cinfo:this.cinfo});if(this.cinfo&&this.cinfo._index&&this.cinfo._index.indexOf("uid,")>=0){var e=this.cinfo._index.split("uid,")[1];window.GRControll.sendInfoRequest(e)}window.clearMarkersInSiv=function(i){if(v&&v.clearMarkers){v.clearMarkers(i)}setSearchResult("")};if(v.json&&v.json.result&&v.json.result.wd){if(v.history&&!place.result){var h=(searchInViewCtrl.isMoving?500:0);setTimeout(function(){searchInViewCtrl.curKw=v.json.result.wd;searchInViewCtrl.prepare()},h)}}if(v.json&&v.json.content&&v.json.content.length>0){addAdsContent(v.json,2)}setComplaintCenterURL(map,this)},_hotelType:function(e,i,b,a,g){var f=this,h="",j={};j[place.URL_PARAM_PREFIX+"data_type"]=e;j[place.URL_PARAM_PREFIX+"sub_type"]=i;j[place.URL_PARAM_PREFIX+"price_section"]=b;j[place.URL_PARAM_PREFIX+"sort_type"]=a;j[place.URL_PARAM_PREFIX+"sort_rule"]=g;j[place.URL_PARAM_PREFIX+"discount_section"]=place.urlParam[place.URL_PARAM_PREFIX+"discount_section"];j[place.URL_PARAM_PREFIX+"groupon_section"]=place.urlParam[place.URL_PARAM_PREFIX+"groupon_section"];h=place.getUrlParamString(j);var d=i;if(i==""){i=f.curKw;d=f.curKw}if(i.indexOf("-")>-1){var c=i.split("-");d=c[c.length-1];if(d==""){d=c[c.length-2]}}if(searchInViewCtrl){searchInViewCtrl.curKw=d;if(searchInViewCtrl.isOpen){searchInViewCtrl._container.onclick()}}go("bd&c="+f.sCityCode+"&wd="+encodeURIComponent(d)+h)},searchByFilter:function(d){var e=this,b=place.getUrlParamString(d),a=d[place.URL_PARAM_PREFIX+"sub_type"],c=a;if(a==""){a=e.curKw;c=e.curKw}if(a.indexOf("-")>-1){var f=a.split("-");c=f[f.length-1];if(c==""){c=f[f.length-2]}}if(searchInViewCtrl){searchInViewCtrl.curKw=c;if(searchInViewCtrl.isOpen){searchInViewCtrl._container.onclick()}}go("bd&c="+e.sCityCode+"&wd="+encodeURIComponent(c)+b)},clearMarkers:function(c){var a=GRControll.openedMarker;for(var b=0,d=this.markers.length;b<d;b++){if(this.markers[b]){map.removeOverlay(this.markers[b])}}this.markers.length=0;this.cInfoWnd=null;for(var b=0,d=this.busPolylines.length;b<d;b++){if(this.busPolylines[b]){map.removeOverlay(this.busPolylines[b])}}this.busPolylines=[];for(var b=0,d=this.busStopPois.length;b<d;b++){if(this.busStopPois[b]){map.removeOverlay(this.busStopPois[b])}}this.busStopPois=[];if(this.unListMarker){map.removeOverlay(this.unListMarker);this.unListMarker=null}if(a){GRControll.openedMarker=a}},unload:function(){var a=GRControll.openedMarker;if(T.G("MapInfo")){T.G("MapInfo").style.overflowX="hidden"}window.GRControll.clearCache();place.result=false;this.json=null;this.curSelA=null;this.points.length=0;this.markers.length=0;this.infoWnds.length=0;this.busStopPois.length=0;this.stationPoints.length=0;this.showIconIndices.length=0;place.urlArr=null;window.place_dateType=null;this.centerPt=null;this.centerPoi=null;this.cInfoWnd=null;this.busPolylines.length=0;this.normPolylines.length=0;this.normPolygons.length=0;if(this.changeRangePopup){this.changeRangePopup.close();this.changeRangePopup=null}if(this.unListMarker){map.removeOverlay(this.unListMarker);this.unListMarker=null}if(a){GRControll.openedMarker=a}},setMissingMarker:function(){var me=this;var pt=getPoiPoint(parseGeo(GRControll.openedMarker.geo).points);var makr=new BMap.Marker(pt,{icon:me.RED_ICON,zIndexFixed:true,baseZIndex:2500000});makr.setTitle(GRControll.openedMarker.name);map.addOverlay(makr);makr._stCode=OVERLAY_STYLE.GEN_MKR1;me.unListMarker=makr;var pars="/?qt=inf&uid="+GRControll.openedMarker.uid+"&ie=utf-8&t="+new Date().getTime();T.Ajax.request(pars,function(res){if(!res||res.responseText==""){return}var js=eval("("+res.responseText+")");if(!js||!js.content){return}var c=js.content;var pt=getPointByStr(parseGeo(c.geo).points);if(!opts){var opts={}}opts.notMove=true;var addr=c.addr;if(c.poiType==POI_TYPE_BUSSTOP||c.poiType==POI_TYPE_SUBSTOP){addr=T.array.unique(addr.split(";")).join("; ")}var tel=c.tel;if(tel){tel=tel.replace(/,/g,", ")}var cate=me._getCateInfo(c.cla);var infoWnd=createSearchInfoWnd({title:c.name,addr:addr,tel:tel,uid:c.uid,cate:cate,poiType:c.poiType,hasDetail:(c.detail&&c.ty==GEO_TYPE_POINT||c.poiType==POI_TYPE_BUSLINE||c.poiType==POI_TYPE_SUBLINE),ext:c.ext,houseDetailUrl:myext._getHouseDetailUrl(c),cp:c.cp,cla:c.cla},{cityCode:me.sCityCode,x:pt.lng,y:pt.lat});if(!infoWnd){return}infoWnd.addEventListener("open",function(){GRControll.setGRequestFlg(1500);if(map.infoWindow.closeButton){T.on(map.infoWindow.closeButton,"click",function(){if(me.unListMarker){me.unListMarker.setIcon(me.RED_ICON);me.unListMarker.setTop(true,1000100);GRControll.openedMarker=null}})}});infoWnd.addEventListener("close",function(){if(me.unListMarker){me.unListMarker.setIcon(me.RED_ICON);me.unListMarker.setTop(true,1000100)}GRControll.openedMarker=null});if(map.temp.infoWin&&map.temp.infoWin.isOpen()==true){var tmpOpenedMarker=GRControll.openedMarker}openSearchInfoWnd(infoWnd,me.unListMarker,opts);if(tmpOpenedMarker){setTimeout(function(){GRControll.openedMarker=tmpOpenedMarker},500)}me.unListInfoW=infoWnd;me.unListOpt=opts;me.unListMarker.setIcon(me.BLUE_ICON);me.unListMarker.setTop(true,1000100);GRControll.mdMarker1&&GRControll.mdMarker1.hide();GRControll.mdMarker2&&GRControll.mdMarker2.hide()});makr.addEventListener("mouseover",function(){makr.setIcon(me.BLUE_ICON);makr.setTop(true,1000100)});makr.addEventListener("mouseout",function(){if(map.temp.infoWin&&map.temp.infoWin.isOpen()==true&&map.temp.infoWin.overlay===this){return}makr.setIcon(me.RED_ICON);makr.setTop(false)});makr.addEventListener("click",function(){if(!me.unListInfoW||!me.unListMarker||!me.unListOpt){return}openSearchInfoWnd(me.unListInfoW,me.unListMarker,me.unListOpt)})},loadData:function(a){},setMarkerOpenInUrl:function(f,g,b,d){var e=this;if(f!=-1&&f!="c"){var c=e.json.content[f]&&e.json.content[f].poiType||-1;if((c==POI_TYPE_BUSLINE||c==POI_TYPE_SUBLINE)&&b!=-1){e._processUrlReappear(c)}else{var a=true;var h=true;if(d&&d.notMove){a=true}else{if(!e.cinfo._centerPoint){a=false}}if(d&&d.notZoom){h=true}else{if(!e.cinfo._maplevel){h=false}}e.select(f,{notMove:a,notZoom:h,forReAppear:true})}}if(f=="c"&&e.cInfoWnd&&e.centerPoi){e._setTop(e.centerPoi,true);openSearchInfoWndPOI(e.cInfoWnd,e.centerPoi);this.curSelIndex="c"}if(c==POI_TYPE_BUSSTOP||c==POI_TYPE_SUBSTOP){setTimeout(function(){e._processUrlReappear(c)},300)}},select:function(g,a){if(!a){var a={}}var i=this.json&&this.json.content||[];var j=this;if(g==this.curSelIndex){if(a.force!=true&&!(this.points[g]&&!map.getBounds().containsPoint(this.points[g]))){if(i[g]&&i[g].poiType!=POI_TYPE_BUSSTOP&&i[g].poiType!=POI_TYPE_SUBSTOP||!i[g]){return}}if(i[g]&&(i[g].poiType==POI_TYPE_BUSSTOP||i[g].poiType==POI_TYPE_SUBSTOP)){if(map.temp.infoWin&&j.markers[g]&&map.temp.infoWin.isOpen()==true&&map.temp.infoWin.overlay===j.markers[g]&&!(j.points[g]&&!map.getBounds().containsPoint(j.points[g]))){return}}}map.closeInfoWindow();this.hideBusInfo(this.curSelIndex);this.curStopSelIndex=-1;if(T.G("line_list_"+this.curLineSelIndex)){T.rc(T.G("line_list_"+this.curLineSelIndex),"selected");this.curLineSelIndex=-1}var h=this.curSelIndex;this.curSelIndex=g;if(j.markers[g]&&!j.markers[g].isVisible()){j.markers[g]=null;j.markers[g]=addSearchPoi(j.points[g],this.showIconIndices[g]-1);j.markers[g].addEventListener("click",function(){j.select(g,{statCode:STAT_GR_MARKER_CLICK})});j.markers[g].addEventListener("mouseover",function(){j.markers[g].setIcon(j._getOverIcon(g))});j.markers[g].addEventListener("mouseout",function(){if(map.temp.infoWin&&map.temp.infoWin.isOpen()==true&&map.temp.infoWin.overlay===this){return}j.markers[g].setIcon(j._getNormIcon(g))});j.markers[g]._l=j.markers[g].iconDom.style.left;j.markers[g]._t=j.markers[g].iconDom.style.top}this._clearBusLine();this._clearLine();this._clearArea();if(i[g]){switch(i[g].ty){case GEO_TYPE_AREA:j._showArea(i,g);break;case GEO_TYPE_LINE:if(i[g].poiType==POI_TYPE_BUSLINE||i[g].poiType==POI_TYPE_SUBLINE){this._showBusLine(i[g].uid,!a.forReAppear,a.showBLCbk,g,1)}else{this._showLine(i,g,a)}break;case GEO_TYPE_POINT:this._showInfoWindow(i,g,a);break;default:break}}if(a&&a.statCode){setTimeout(function(){addStat(a.statCode,{n:g,uid:i[g].uid,ct:a.ct})},1000)}if(h!=g){if(j.curSelA){T.rc(j.curSelA,"focus");T.rc(j.curSelA,"focus-over")}}var b=T.G("item-td-"+g);if(b){T.ac(b,"focus");T.rc(b,"focus-over");j.curSelA=b}var e=j.markers[h];if(e){this._setTop(e,false)}var f=j.markers[g];if(f&&!(a.forReAppear&&this.reIndex[1]!=-1)){var j=this;setTimeout(function(){j._setTop(f,true)},200)}this._setShareSelIndex(this.curSelIndex);if(this.markers[g]){var d=1;if(!map.temp.infoWin||!map.temp.infoWin.isOpen()){d=50}setTimeout(function(){j.markers[g].setIcon(j._getOverIcon(g))},d);GRControll.mdMarker1&&GRControll.mdMarker1.hide();GRControll.mdMarker2&&GRControll.mdMarker2.hide()}return false},setComponentList:function(a){this.select(a)},_showInfoWindow:function(i,b,f){var e=this;if(!f){var f={}}if(f.forReAppear==true&&this.reIndex[1]!=-1&&(i[b].poiType==POI_TYPE_BUSLINE||i[b].poiType==POI_TYPE_SUBLINE||i[b].poiType==POI_TYPE_BUSSTOP||i[b].poiType==POI_TYPE_SUBSTOP)){return}var h=i[b].addr;if(i[b].poiType==POI_TYPE_BUSSTOP||i[b].poiType==POI_TYPE_SUBSTOP){h=T.array.unique(h.split(";")).join("; ")}var a=i[b].tel;if(a){a=a.replace(/,/g,", ")}var d=this._getCateInfo(i[b].cla);var g=null;if(i[b].ext&&i[b].ext.src_name&&e.placeRe.test(i[b].ext.src_name)){addStat(window["STAT_PLACE_"+i[b].ext.src_name.toUpperCase()+"_LIST"])}g=createSearchInfoWnd({title:i[b].name,addr:h,tel:a,uid:i[b].uid,cate:d,poiType:i[b].poiType,hasDetail:i[b]._hasDetail,ext:i[b].ext,houseDetailUrl:myext._getHouseDetailUrl(i[b]),cp:i[b].cp,cla:i[b].cla},{cityCode:this.sCityCode,x:e.points[b].lng,y:e.points[b].lat});if(!g){return}g._aIndex=b;(function(){var j=b;var c=function(l){var k=T.G("item-td-"+l);T.rc(k,"focus");T.rc(k,"focus-over");e.curA=null;var m=e.markers[e.curSelIndex];if(m){m.setIcon(e._getNormIcon(b));m.setTop(false)}e.curSelIndex=-1;e._setShareSelIndex(-1)};g.addEventListener("close",function(){c(j);GRControll.openedMarker=null;g.removeEventListener("close",arguments.callee)});g.addEventListener("open",function(){if(map.infoWindow.closeButton){T.on(map.infoWindow.closeButton,"click",function(){c(j);GRControll.openedMarker=null;T.un(map.infoWindow.closeButton,"click",arguments.callee)})}GRControll.openedMarker={uid:i[b].uid,geo:i[b].geo,name:i[b].name};g.removeEventListener("open",arguments.callee)})})();openSearchInfoWndPOI(g,e.markers[b],f)},_showLine:function(f,a,e){var b=f[a].uid;var d=this;if(!e){var e={}}go("ext&uid="+b+"&l="+(BMap.MapType[map.mapType].zoomLevelMax-1)+"&c="+d.sCityCode,function(m){if(!m||m&&!m.content){return}var k=parseGeo(m.content.geo);if(k.type==2){var r=[];if(typeof k.points=="string"){d.normPolylines.push(addRoute(k.points));var s=k.points.split(";");for(var n=0,g=s.length;n<g;n++){var c=s[n].split(",");r.push(new BMap.Point(c[0],c[1]))}}else{for(var n=0,g=k.points.length;n<g;n++){if(!k.points[n]){continue}d.normPolylines.push(addRoute(k.points[n]));var u=k.points[n].split(";");for(var h=0,q=u.length;h<q;h++){r.push(new BMap.Point(parseFloat(u[h].split(",")[0]),parseFloat(u[h].split(",")[1])))}}}if(f[a]._views){if(map.zoomLevel!=f[a]._views.level&&!e.notZoom){}else{var o=k.bound.split(";");var p=new BMap.Bounds(o[0].split(",")[0],o[0].split(",")[1],o[1].split(",")[0],o[1].split(",")[1])}e.notZoom=true;d._showInfoWindow(f,a,e)}else{e.notZoom=true;d._showInfoWindow(f,a,e)}}})},_clearLine:function(){for(var b=0,a=this.normPolylines.length;b<a;b++){removeRoute(this.normPolylines[b]);this.normPolylines[b]=null}this.normPolylines.length=0},_showArea:function(d,a){if(!d[a]){return}var b=this;go("ext&uid="+d[a].uid+"&c="+this.sCityCode,function(k){if(!k||k&&!k.content){return}var e=parseGeo(k.content.geo).points;var g=[];if(typeof e=="string"){b.normPolygons.push(addArea(e,AREA_TYPE_NORM));var n=e.split(";");for(var h=0,c=n.length;h<c;h++){g.push(new BMap.Point(parseFloat(n[h].split(",")[0]),parseFloat(n[h].split(",")[1])))}}else{for(var h=0,c=e.length;h<c;h++){if(!e[h]){continue}b.normPolygons.push(addArea(e[h]),AREA_TYPE_NORM);var n=e[h].split(";");for(var f=0,m=n.length;f<m;f++){g.push(new BMap.Point(parseFloat(n[f].split(",")[0]),parseFloat(n[f].split(",")[1])))}}}window.GRControll.setGRequestFlg(1000);setViewport(g)})},_clearArea:function(){for(var b=0,a=this.normPolygons.length;b<a;b++){removeArea(this.normPolygons[b]);this.normPolygons[b]=null}this.normPolygons.length=0},_setColContent:function(Z,W,h,k){var d=this.guid,K=Z[W].poiType;h.push('<tr id="item-td-'+W+'" onmouseover="Instance(\''+d+"')._itemOver(this, "+W+", "+K+')" onmouseout="Instance(\''+d+"')._itemOut(this, "+W+", "+K+')">');if(Z[W].poiType==POI_TYPE_BUSLINE){h.push('<th><div class="bl_icon"></div></th>')}else{if(Z[W].poiType==POI_TYPE_SUBLINE){h.push('<th><div class="sl_icon"></div></th>')}else{h.push('<th><div id="no'+k+'" class="icon" onclick="Instance(\''+this.guid+"').select("+W+', {statCode:STAT_GR_ITEM_CLICK})" title="在图上显示该点">');h.push("</div></th>")}}h.push("<td>");if(K!=POI_TYPE_NORMAL){h.push("<div>")}h.push('<div style="overflow:hidden;clear:both;*overflow:visible;">');if(isCorrect(Z[W])){h.push('<a href="javascript:void(0)" onclick="goCorrect(1,\''+Z[W].uid+'\');return false;" class="correct" title="纠错"><img alt="纠错" src="'+MapConfig.smFlwCon+'image/transparent.gif" /></a>')}if(sms.isActive){h.push('<a href="javascript:void(0)" onclick=\'sms.ready(this, "'+Z[W].uid+'", "'+K+'", "'+this.sCityCode+'","list");return false;\' class="stml" title="免费发送到手机/汽车"><img alt="免费发送到手机/汽车" src="'+MapConfig.smFlwCon+'image/transparent.gif"></a>')}if(!window.isPrint){var p=[],z=Z[W].addr,B=Z[W].tel&&Z[W].tel.replace(/(,|;)/ig,", ").replace("、","<br />");if(z){if(Z[W].poiType==POI_TYPE_BUSSTOP||Z[W].poiType==POI_TYPE_SUBSTOP){p.push("车次:"+z+"<br/>")}else{p.push("地址:"+z+"<br/>")}}if(B){p.push("电话:"+B)}p=p.join("");var S=getPointByStr(parseGeo(Z[W].geo).points),G=S.lng+"|"+S.lat,x={point:G,uid:Z[W].uid,cityCode:this.sCityCode,title:Z[W].name,content:p},r=window._gl&&window._gl.checkInFav("",{from:"poi",json:x}),y="",C="加入收藏夹",F=C;if(r!=null&&r!=-1){y="poi-fav-selected";C="取消收藏";F=C}h.push('<a id="poifav_'+Z[W].uid+'" href="javascript:void(0)" onclick="addStat(STAT_FAV_LIST_BTN,{\'uid\':\''+Z[W].uid+"'});_gl.goFav({'point':'"+G+"','uid':'"+Z[W].uid+"','cityCode':'"+this.sCityCode+"','title':'"+T.encodeHTML(Z[W].name)+"','content':'"+T.encodeHTML(p)+'\'});return false;" class="poi-fav '+y+'" title="'+C+'"><img class="favorite" alt="'+F+'" src="'+MapConfig.smFlwCon+'image/transparent.gif"></a>')}h.push('<a id="link'+W+"_show_"+this.guid+'" href="javascript:void(0)" onclick="return Instance(\''+this.guid+"').select("+W+', {statCode:STAT_GR_ITEM_CLICK})">');h.push(Z[W].name);if(K==POI_TYPE_BUSSTOP){h.push("-公交车站")}else{if(K==POI_TYPE_SUBSTOP){h.push("-地铁站")}}h.push("</a>");var g=Z[W].ext,M=g?g.src_name:"",I=this.json.place_info;if(Z[W].detail&&Z[W].ty==GEO_TYPE_POINT||K==POI_TYPE_BUSLINE||K==POI_TYPE_SUBLINE){if(g&&((M=="biaozhu_data"&&g.yw_type=="1")||this.placeRe.test(M))){var f="详情";if(M=="biaozhu_data"&&g.yw_type=="1"){h.push(' - <a class="detail blueA" tid="poiDetail_'+W+'" href="javascript:void(0)" onclick="showDetail(\''+Z[W].uid+"', "+K+", "+this.sCityCode+", 'ISHOP_INFO');return false;\">详情»</a> <img src=\""+MapConfig.smFlwCon+'image/yw.gif" style="position:relative;top:3px"/>')}else{var X=M.toUpperCase()+"_";h.push(' - <a class="detail blueA" tid="poiDetail_'+W+'" href="javascript:void(0)" onclick="showDetail(\''+Z[W].uid+"', "+K+", "+this.sCityCode+", '"+M+"','Page','List');addStat(window['STAT_' +'"+X+"' + 'PLACE_TEXT_DETAIL']);return false;\">"+f+"»</a>")}}else{h.push(' - <a class="detail blueA" tid="poiDetail_'+W+'" href="javascript:void(0)" onclick="showDetail(\''+Z[W].uid+"', "+Z[W].poiType+", "+this.sCityCode+');return false;">详情»</a>')}Z[W]._hasDetail=true}h.push("</div>");if(g&&g.detail_info&&g.detail_info.image){var X=M.toUpperCase()+"_",P=Z[W].ext.detail_info.image,D="http://map.baidu.com/maps/services/thumbnails?width=54&height=40&src="+encodeURIComponent(P);h.push('<div class="hotelImg"><div class="hotelImgBox"><img src="'+P+'" onclick="showDetail(\''+Z[W].uid+"', "+K+", "+this.sCityCode+", '"+M+"','Page_Pic','List');addStat(window['STAT_'+'"+X+"'+'PLACE_TEXT_IMG'])\"  /></div></div>")}if(this.json.result.db==1&&Z[W].debug_str){h.push("<br /><span>debug: "+Z[W].debug_str+"</span>")}if(K==POI_TYPE_BUSLINE||K==POI_TYPE_SUBLINE){h.push("</div><div>");h.push('<div class="poi_bus_show" id="bus_info_link_'+W+'" ><a class="btn_bus_show" href="javascript:void(0)" onclick="addStat(STAT_POI_UNFOLD);return Instance(\''+this.guid+"').showBusInfo("+W+')">途经车站</a></div>');h.push('<div class="poi_bus_list" id="bus_info_'+W+'" style="display:none"></div>');h.push("</div>")}if(Z[W].addr){if(K==POI_TYPE_BUSSTOP||K==POI_TYPE_SUBSTOP){var J="途经公交车";var H="公交";if(K==POI_TYPE_SUBSTOP){J="途经地铁";H="地铁"}h.push('<p><span class="poi_bustrans">'+J+"：</span>"+T.array.unique(Z[W].addr.split(";")).join("; ")+"</p>");h.push("</div>");h.push('<div class="poi_bus_show"><a class="btn_bus_show" tid="poiDetail_'+W+'" id="btn_unfold_bsline_'+W+'" href="javascript:void(0)" onclick="addStat(STAT_POI_UNFOLD);return Instance(\''+this.guid+"').showBusList(this)\">详情</a></div>");h.push('<div class="poi_bus_list" style="display:none">');h.push('<a class="btn_bus_hide" href="javascript:void(0)" onclick="return Instance(\''+this.guid+"').hideBusList(this)\">点击列表查看线路详情</a>");h.push("<div class='bus'><table cellspacing='0' cellpadding='0' class='line'>");var aa=Z[W].addr.split(";");this.curLines=Z[W].blinfo;for(var U=0,Q=Z[W].blinfo.length;U<Q;U++){var m=T.trim(aa[U]);if(m===""){continue}h.push("<tr id='line_list_"+W+"_"+U+"'>");h.push("<th style='list_arrow'><img src='styles/bmap/blank.gif' class='list_arrow'/></th>");h.push("<td style='white-space:nowrap'>"+m+"</td>");h.push("<td><a href='javascript:void(0)'");h.push("onclick='addStat(STAT_POI_SELSUB);return Instance(\""+this.guid+'").selectBusLine('+U+', "'+Z[W].blinfo[U].uid+'", '+W+")'>("+Z[W].blinfo[U].name+")</a></td>");h.push("</tr>")}h.push("</table></div>");h.push("</div>")}else{if(K==POI_TYPE_NORMAL||typeof Z[W].poiType=="undefined"){h.push('<p class="n_p_lineheight">地址：'+Z[W].addr+"</p>");if(Z[W].tel){h.push('<p tid="itemTel_'+W+'" class="n_p_lineheight">电话：'+Z[W].tel.replace(/,/g,", "))}h.push("</p>")}}}else{if(Z[W].tel){h.push('<p tid="itemTel_'+W+'" class="n_p_lineheight">电话：'+Z[W].tel.replace(/,/g,", ")+"</p>")}}if(g&&I&&this.placeRe.test(g.src_name)&&(g.src_name==I.d_data_type||I.d_data_type=="")&&g.detail_info){var R=g.detail_info,L,N,X=M.toUpperCase()+"_";if(R.overall_rating||(R.comment_num&&R.comment_num!="0")){h.push('<p class="hotel_res">');if(R.overall_rating){L=Math.round((R.overall_rating*1)*(64/5));L=isNaN(L)?0:L;if(L>0){h.push('<span tid="score_'+W+'" class="score"><b style="width:'+L+'px">评分</b></span>')}}if(R.comment_num&&g.src_name!="hospital"){N=isNaN(R.comment_num)?0:R.comment_num;if(N>0){h.push('<span class="review_num"><a tid="poiComment_'+W+'" class="review" href="javascript:void(0)" onclick="showDetail(\''+Z[W].uid+"', "+K+", "+this.sCityCode+", '"+M+"','Page_Comm','List');addStat(window['STAT_'+'"+X+"'+'PLACE_TEXT_COMMENT']);return false;\">"+N+"篇评论</a></span>")}}h.push("</p>")}if(R.price||(I&&(I.d_sort_type=="health_score"&&R.hygiene_rating)||(I.d_sort_type=="taste_rating"&&R.taste_rating)||(I.d_sort_type=="service_rating"&&R.service_rating))){h.push('<p class="n_p_lineheight">');var E=this.placeConfig.basicInfoCN[Z[W].ext.src_name];if(R.price){var A=parseFloat(R.price),o=E.price,t=E.priceUnit;if(!isNaN(A)&&A>0&&o&&t){h.push('<span tid="itemPrice_'+W+'">'+o+"："+A+t+"&nbsp;&nbsp;</span>")}}if(I&&I.d_sort_type=="health_score"&&R.hygiene_rating){h.push('<span tid="hygiene_rating" class="hygiene_rating">'+E.hygiene_rating+"："+R.hygiene_rating+"</span>")}if(I&&I.d_sort_type=="service_rating"&&R.service_rating){h.push('<span tid="hygiene_rating" class="hygiene_rating">'+E.service_rating+"："+R.service_rating+"</span>")}if(I&&I.d_sort_type=="taste_rating"&&R.taste_rating){h.push('<span tid="hygiene_rating" class="hygiene_rating">'+E.taste_rating+"："+R.taste_rating+"</span>")}h.push("</p>")}if(this.placeRe.test(M)&&R.tag&&!R.other_movie_num){var Y=R.tag.replace(new RegExp(",","gm")," ");h.push('<p tid="itemTag_'+W+'" class="map_tagBox">标签：'+Y+"");h.push("</p>")}if(R.premium&&Object.prototype.toString.call(R.premium)=="[object Array]"){var q=R.premium[0];discount_title=q.discount_title;if(discount_title.length>15){discount_title=discount_title.substr(0,15)+"..."}h.push(['<p class="place-preferential">',"<a onclick=\"showDetail('"+Z[W].uid+"', "+K+", "+this.sCityCode+", '"+M+"','page_discount','List');addStat('"+STAT_PLACE_LINK_LIST_PREMIUM+'\')" href="javascript:void(0)">',"<em></em><strong>"+discount_title+"</strong>","</a></p>"].join(""))}if(R.groupon&&Object.prototype.toString.call(R.groupon)=="[object Array]"){h.push(['<p class="place-preferential groupon">',"<a onclick=\"showDetail('"+Z[W].uid+"', "+K+", "+this.sCityCode+", '"+M+"','groupon','List');return false\" href=\"javascript:void(0)\">","<em></em><strong>"+R.groupon.length+"条团购信息</strong>","</a></p>"].join(""))}if(R.other_movie_num){h.push(['<p class="link" style="text-decoration:none;"><span>今日上映&nbsp;'+R.other_movie_num+"部电影，</span>","<a onclick=\"showDetail('"+Z[W].uid+"', "+K+", "+this.sCityCode+", '"+M+"','other_movie','List');return false\" href=\"javascript:void(0)\">","查看放映表&gt;&gt;","</a></p>"].join(""))}}if(!this.placeRe.test(M)){if(Z[W].show_tag!=""&&Z[W].show_tag&&Z[W].show_tag.length>0&&Z[W].tag_num!="0"){h.push('<p tid="itemTag_'+W+'" class="map_tagBox">标签：');for(U=0;U<Z[W].show_tag.length;U++){h.push('<span class="map_tagList">'+Z[W].show_tag[U]+"</span>")}h.push("</p>")}}if(Z[W].ext&&Z[W].ext.src_name=="biaozhu_data"&&Z[W].ext.yw_type!="0"){if(Z[W].ext.detail_info&&Z[W].ext.detail_info.length>1&&Z[W].ext.detail_info[1].type&&Z[W].ext.detail_info[1].type.length>1){var e=Z[W].ext.detail_info[1].type[1].split("-");var v=false;for(var U=0,N=e.length;U<N;U++){if(e[U]=="餐饮"){v=true}}if(v){for(var U=0,N=Z[W].ext.detail_info[1].custom.length;U<N;U++){var s=Z[W].ext.detail_info[1].custom[U];if((s.t=="人均价"&&s.c!="")||(s.t=="菜系"&&s.c!="")){h.push("<p>"+s.t+"："+s.c+"</p>")}}}}var V=[];var O="http://map.baidu.com/ishop/detail.html?newmap=1&s="+encodeURIComponent("inf&uid="+Z[W].uid+"&c="+this.sCityCode+"&newmap=1");if(Z[W].ext.youhui_info.length>0){if(Z[W].ext.youhui_info[0].info!=""||Z[W].ext.youhui_info[0].pics!=""){V.push('<a href="'+O+'#speresult" target="_blank">优惠信息</a>')}}if(Z[W].ext.pic_info.length>0){V.push('<a href="'+O+'#picresult" target="_blank">图片</a>')}h.push(V.join("&nbsp;&nbsp;"))}if(Z[W].ext&&Z[W].ext.title_link){var b=Z[W].ext.title_link;for(var U=0,Q=b.length;U<Q;U++){h.push('<a href="'+b[U].link+'" target="_blank" onclick="nsClick(this.href, \''+Z[W].ext.src_name+"')\">"+b[U].title+"</a>");if(U<Q-1){h.push("&nbsp;&nbsp;")}}}if(typeof(Z[W].ext_type)!="undefined"&&!!(Z[W].ext_type&2)){var u=myext._getHouseDetailUrl(Z[W]);h.push('<p><a href="javascript:void(0)" onclick ="addStat('+STAT_PLACE_HOUSE_WINGOTOBDLEJU+");window.open('"+u+'\');return false;" class="housedetail">查看房产地图&raquo;</a></p>')}h.push("</td>");h.push("</tr>");h.push('<tr style="height:5px"><th></th><td style="font-size:0"></td></tr>')},_itemOver:function(c,b,a){if(c&&this.curSelIndex!=b){T.ac(c,"focus-over")}var e=this;var d=e.markers;if(!d[b]||!d[b].isVisible()){return}d[b].setIcon(e._getOverIcon(b));d[b].setTop(true,1000100)},_itemOut:function(c,b,a){if(c&&this.curSelIndex!=b){T.rc(c,"focus-over")}var e=this;var d=e.markers;if(!d[b]||!d[b].isVisible()){return}if(map.temp.infoWin&&map.temp.infoWin.isOpen()==true&&map.temp.infoWin.overlay===d[b]){return}d[b].setIcon(e._getNormIcon(b));d[b].setTop(false)},_getCateInfo:function(d){var c=[];for(var e=0,b=d.length;e<b;e++){c.push(d[e][1]);if(e<b-1){c.push(", ")}}return c.join("")},showBusList:function(b){b.parentNode.style.display="none";b.parentNode.nextSibling.style.display="block";return false},hideBusList:function(b){b.parentNode.style.display="none";b.parentNode.previousSibling.style.display="block";return false},_showBusLine:function(uid,showAll,callback,i,tp){var me=this;this._clearBusLine();this._clearLine();this._clearArea();this.curBslUid=uid;if(this.bslReq){this.bslReq.abort();this.bslReq=null}this.bslReq=getXhr();this.bslReq.onreadystatechange=function(){if(me.bslReq.readyState==4&&me.bslReq.status==200){var data;try{eval("data="+me.bslReq.responseText)}catch(e){return}if(!data||data&&!data.content){return}var c=data.content[0];if(c.uid!=me.curBslUid){return}me._drawBusLine(c,showAll,i);if(callback&&typeof callback=="function"){callback(data)}}};var tps="";if(tp){tps="&bsltp=1"}this.bslReq.open("get","/?qt=bsl"+tps+"&newmap=1&uid="+uid+"&c="+me.sCityCode+"&t="+new Date().getTime());this.bslReq.send(null)},_drawBusLine:function(k,f,e){var g=this;var h=parseGeo(k.geo);if(h&&h.type==2){g.busPolylines.push(addRoute(h.points,ROUTE_TYPE_BUS))}if(!k||k&&!k.stations){return}var d=g.curStops=k.stations;g.stationPoints=[];g.busStopPois=[];for(var b=0,a=d.length;b<a;b++){(function(){var c=b;var i=parseGeo(d[c].geo);if(i.type==1){var j=addBusStopPoi(i.points,d[c].name);g.busStopPois.push(j);j.addEventListener("click",function(){g.selectBusStop(c,k.name,e)});g.stationPoints.push(getPoiPoint(i.points))}})()}if(f){window.GRControll.setGRequestFlg(1000);setViewport(g.stationPoints,10)}},_clearBusLine:function(){if(this.busPolylines){for(var b=0,a=this.busPolylines.length;b<a;b++){removeRoute(this.busPolylines[b]);this.busPolylines[b]=null}this.busPolylines.length=0}for(var b=0;b<this.busStopPois.length;b++){if(this.busStopPois[b]){this.busStopPois[b].remove();this.busStopPois[b]=null}}this.busStopPois.length=0;this.stationPoints.lengtn=0;this.curStopSelIndex=-1;this._setShareSelIndex(this.curSelIndex)},selectBusLine:function(b,e,d,c,a){showDetail(e,POI_TYPE_BUSLINE,modelConfig.cityCode)},showBusInfo:function(b,d){var c=this;d=d||{};var e={force:true,showBLCbk:function(h){if(!h||h&&!h.content){return}var p=h.content[0];if(!p){return}var f=T.G("bus_info_"+b);if(!f){return}f.style.display="block";var l=T.G("bus_info_link_"+b);if(l){l.style.display="none"}var n=["<div class='bus'><table cellspacing='0' cellpadding='0' class='station'>"];var o=c.curStops=p.stations;var i=o.length;var k=c.json.content;for(var g=0;g<o.length;g++){var m=o[g];n.push("<tr id='stop_list_"+b+"_"+g+"'>");n.push("<th style='white-space:nowrap'><img src='styles/bmap/blank.gif' class='list_arrow' />"+(g+1)+"</th>");n.push("<td><a href='javascript:void(0)' onclick='addStat(STAT_POI_SELSUB);return Instance(\""+c.guid+'").selectBusStop('+g+', "'+k[b].name+'", '+b+")'>"+m.name+"</a></td>");n.push("</tr>")}n.push("</table></div>");f.innerHTML='<a class="btn_bus_hide" href="javascript:void(0)" onclick="return Instance(\''+c.guid+"').hideBusInfo('"+b+"')\">点击站名查看车站位置</a>"+n.join("");if(d.sbiCbk&&typeof d.sbiCbk=="function"){d.sbiCbk()}}};for(var a in d){e[a]=d[a]}this.select(b,e)},hideBusInfo:function(c){var a=T.G("bus_info_link_"+c);if(a){a.style.display="block"}var b=T.G("bus_info_"+c);if(b){b.style.display="none"}},_processNoResult:function(d,c){var a=[];var e=this.sCityName;c=c.replace(/#result_title#/,"").replace(/#list#/,"").replace(/#page#/,"").replace(/#feedback#/,"");var b="http://www.baidu.com/s?ie=utf-8&wd="+encodeURIComponent(this.curKw)+"&cl=3";if(place.result){a=["<p>对不起，在<strong>当前视图区域</strong>内未找到符合<strong>筛选条件</strong>的地点。"];a.push("<div class='nr_suggest'>百度建议您：","<ul><li>拖动或者缩放视图区域；</li>","<li>更改筛选条件；</li>","</ul></div>")}else{a=["<p>对不起，在<strong>当前视图区域</strong>内未找到相关地点。"];a.push("<div class='nr_suggest'>百度建议您：","<ul><li>看看输入的文字是否有误</li>","<li>尝试更换输入文字：去掉过于冗长的部分，并用空格键将多个关键词分开</li>",'<li>在百度网页中查找“<a href="'+b+'">'+this.curKw+"</a>”</li>","</ul></div>")}return c.replace(/#no_result#/,a.join(""))},selectBusStop:function(e,k,b,a){if(this.curStopSelIndex==b+"_"+e){if(!(this.stationPoints[e]&&!map.getBounds().containsPoint(this.stationPoints[e]))){return}}var j=this;var d=this.curStops;if(!d){return}var h=this.json.content;var g=j.busStopPois[e];map.closeInfoWindow();var f=this.curStopSelIndex;this.curStopSelIndex=b+"_"+e;this._setShareSelIndex(b);if(!d[e]){return}window.GRControll.isClearBeforeSend=false;go("inf&uid="+d[e].uid+"&c="+j.sCityCode+"&it="+STAT_INF_STOP,function(i){if(!i){return}var l=k;if(i.content&&i.content.addr){l=i.content.addr}l=T.array.unique(l.split(";")).join("; ");var c=createSearchInfoWnd({title:d[e].name,addr:l,uid:d[e].uid,poiType:i.content.poiType},{forBusLine:true,cityCode:j.sCityCode,x:j.stationPoints[e].lng,y:j.stationPoints[e].lat});c.addEventListener("close",function(){if(T.G("stop_list_"+j.curStopSelIndex)){T.rc(T.G("stop_list_"+j.curStopSelIndex),"selected")}j.curStopSelIndex=-1;j._setShareSelIndex(j.curSelIndex)});openSearchInfoWndPOI(c,g,a)});if(T.G("stop_list_"+f)){T.rc(T.G("stop_list_"+f),"selected")}if(T.G("stop_list_"+this.curStopSelIndex)){T.ac(T.G("stop_list_"+this.curStopSelIndex),"selected")}},_setTop:function(c,b,a){if(!c||!c.setTop){return}if(b&&!c._isTop){c._isTop=true;if(a){c.setTop(true,1000100)}else{c.setTop(true)}return}if(!b){delete c._isTop;c.setTop(false)}},_showSpacePoi:function(b,a){if(!b){return}go("tpl:SpacePoi?ext&uid="+b+"&l="+(BMap.MapType[map.mapType].zoomLevelMax-3)+"&c="+this.sCityCode+"&wd="+encodeURIComponent(a),{cinfo:{poiName:a}})},_setShareSelIndex:function(d){var c=this.curLineSelIndex;var b=this.curStopSelIndex;if(typeof d=="undefined"){d=-1}if(typeof c=="undefined"){c=-1}else{c=this.curLineSelIndex+"";c=c.split("_")&&c.split("_")[1]||-1}if(typeof b=="undefined"){b=-1}else{b=this.curStopSelIndex+"";b=b.split("_")&&b.split("_")[1]||-1}var a="";if(this.json.content&&this.json.content[d]){a="|"+this.json.content[d].uid}Share.listIndex=d+"|"+c+"|"+b+a},_processUrlReappear:function(d){if(d==-1||!this.cinfo._index){return}var a=this.reIndex[0];var b=this.reIndex[1];var f=this.reIndex[2];var e=this;if(d==POI_TYPE_BUSLINE||d==POI_TYPE_SUBLINE){if(f!=-1){setTimeout(function(){e.showBusInfo(a,{forReAppear:true,sbiCbk:function(){e.selectBusStop(f,"",a,{notMove:true,notZoom:true})}})},100)}else{setTimeout(function(){e.selectBusStop(f,"",e.curSelIndex,{notMove:true,notZoom:true})},100)}}else{if(d==POI_TYPE_BUSSTOP||d==POI_TYPE_SUBSTOP){var g=this.json.content;if(g[this.curSelIndex]&&g[this.curSelIndex].blinfo[b]&&g[this.curSelIndex].blinfo[b].uid){this.selectBusLine(b,g[this.curSelIndex].blinfo[b].uid,this.curSelIndex,true,function(){if(f!=-1){setTimeout(function(){e.selectBusStop(f,"",a,{notMove:true,notZoom:true})},100)}});if(T.G("btn_unfold_bsline_"+this.curSelIndex)){this.showBusList(T.G("btn_unfold_bsline_"+this.curSelIndex))}}}}},_getNormIcon:function(a){return new BMap.Icon(A_J_MARKER_NEWYEAR_IMG,A_J_MARKER_NEWYEAR_RED_SIZE,{offset:A_J_MARKER_NEWYEAR_RED_OFFSET,imageOffset:new BMap.Size(-A_J_MARKER_RED_ICON_WID*a,0),infoWindowOffset:A_J_MARKER_NEWYEAR_INFOWND_OFFSET})},_getOverIcon:function(a){return new BMap.Icon(A_J_MARKER_NEWYEAR_IMG,A_J_MARKER_NEWYEAR_BLUE_SIZE,{offset:A_J_MARKER_NEWYEAR_BLUE_OFFSET,imageOffset:new BMap.Size(-(A_J_MARKER_BLUE_ICON_WID)*a,-A_J_MARKER_BLUE_ICON_Y),infoWindowOffset:A_J_MARKER_NEWYEAR_INFOWND_OFFSET})}});
</script>
